<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OrbitControls æµ‹è¯•</title>
  <style>
    body {
      margin: 0;
      padding: 20px;
      font-family: Arial, sans-serif;
      background: #f0f0f0;
    }

    .test-container {
      max-width: 600px;
      margin: 0 auto;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .test-item {
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }

    .success {
      border-color: #4CAF50;
      background: #f1f8e9;
    }

    .error {
      border-color: #f44336;
      background: #ffebee;
    }

    .info {
      border-color: #2196F3;
      background: #e3f2fd;
    }

    button {
      background: #2196F3;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 4px;
      cursor: pointer;
      margin: 5px;
    }

    button:hover {
      background: #1976D2;
    }

    #log {
      background: #f5f5f5;
      padding: 10px;
      border-radius: 4px;
      font-family: monospace;
      white-space: pre-wrap;
      max-height: 300px;
      overflow-y: auto;
    }
  </style>
</head>

<body>
  <div class="test-container">
    <h1>OrbitControls å¯¼å…¥æµ‹è¯•</h1>

    <div class="test-item info">
      <h3>æµ‹è¯•è¯´æ˜</h3>
      <p>æ­¤é¡µé¢ç”¨äºæµ‹è¯•Three.jså’ŒOrbitControlsçš„å¯¼å…¥æ˜¯å¦æ­£ç¡®ã€‚</p>
    </div>

    <div class="test-item">
      <h3>å¯¼å…¥æµ‹è¯•</h3>
      <button onclick="testImports()">æµ‹è¯•å¯¼å…¥</button>
      <button onclick="testOrbitControls()">æµ‹è¯•OrbitControls</button>
      <button onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
    </div>

    <div class="test-item">
      <h3>æµ‹è¯•æ—¥å¿—</h3>
      <div id="log"></div>
    </div>
  </div>

  <script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/examples/jsm/controls/OrbitControls.js';

    window.testImports = function () {
      log('å¼€å§‹æµ‹è¯•å¯¼å…¥...', 'info');

      try {
        // æµ‹è¯•THREEå¯¼å…¥
        if (THREE) {
          log('âœ“ THREE.js å¯¼å…¥æˆåŠŸ', 'success');
          log(`  THREEç‰ˆæœ¬: ${THREE.REVISION}`, 'info');
        } else {
          log('âœ— THREE.js å¯¼å…¥å¤±è´¥', 'error');
        }

        // æµ‹è¯•OrbitControlså¯¼å…¥
        if (OrbitControls) {
          log('âœ“ OrbitControls å¯¼å…¥æˆåŠŸ', 'success');
          log(`  OrbitControlsç±»å‹: ${typeof OrbitControls}`, 'info');
        } else {
          log('âœ— OrbitControls å¯¼å…¥å¤±è´¥', 'error');
        }

        // æµ‹è¯•æ„é€ å‡½æ•°
        if (typeof OrbitControls === 'function') {
          log('âœ“ OrbitControls æ˜¯æ„é€ å‡½æ•°', 'success');
        } else {
          log('âœ— OrbitControls ä¸æ˜¯æ„é€ å‡½æ•°', 'error');
        }

      } catch (error) {
        log(`âœ— å¯¼å…¥æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
      }
    };

    window.testOrbitControls = function () {
      log('å¼€å§‹æµ‹è¯•OrbitControlså®ä¾‹åŒ–...', 'info');

      try {
        // åˆ›å»ºåœºæ™¯
        const scene = new THREE.Scene();
        log('âœ“ åœºæ™¯åˆ›å»ºæˆåŠŸ', 'success');

        // åˆ›å»ºç›¸æœº
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        log('âœ“ ç›¸æœºåˆ›å»ºæˆåŠŸ', 'success');

        // åˆ›å»ºæ¸²æŸ“å™¨
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(100, 100);
        log('âœ“ æ¸²æŸ“å™¨åˆ›å»ºæˆåŠŸ', 'success');

        // åˆ›å»ºOrbitControls
        const controls = new OrbitControls(camera, renderer.domElement);
        log('âœ“ OrbitControls å®ä¾‹åŒ–æˆåŠŸ', 'success');
        log(`  controlsç±»å‹: ${typeof controls}`, 'info');

        // æµ‹è¯•controlså±æ€§
        if (controls.enableDamping !== undefined) {
          log('âœ“ controls.enableDamping å±æ€§å­˜åœ¨', 'success');
        }
        if (controls.update !== undefined) {
          log('âœ“ controls.update æ–¹æ³•å­˜åœ¨', 'success');
        }

        log('ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼OrbitControlså¯ä»¥æ­£å¸¸ä½¿ç”¨', 'success');

      } catch (error) {
        log(`âœ— OrbitControlsæµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
        log(`  é”™è¯¯å †æ ˆ: ${error.stack}`, 'error');
      }
    };

    function log (message, type = 'info') {
      const logDiv = document.getElementById('log');
      const timestamp = new Date().toLocaleTimeString();
      const logEntry = `[${timestamp}] ${message}\n`;
      logDiv.textContent += logEntry;
      logDiv.scrollTop = logDiv.scrollHeight;
    }

    window.clearLog = function () {
      document.getElementById('log').textContent = '';
    };

    // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æµ‹è¯•
    window.addEventListener('load', () => {
      log('é¡µé¢åŠ è½½å®Œæˆï¼Œå¯ä»¥å¼€å§‹æµ‹è¯•', 'info');
    });
  </script>
</body>

</html>